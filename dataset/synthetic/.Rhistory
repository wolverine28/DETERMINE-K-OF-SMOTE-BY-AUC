RoundingTimes <-list(W[[1]][,1],W[[2]][,1],W[[3]][,1])
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
k
n
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
D
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
pchisq(q = H,df = k-1,lower.tail = F)
0.05 /k*(k-1)
qnorm(0.05 /k*(k-1),lower.tail = F)
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)
unlist(lapply(D,mean))
combn(unlist(lapply(D,mean)))
combn(unlist(lapply(D,mean))m = 2)
combn(unlist(lapply(D,mean)),m = 2)
RoundingTimes <-list(W[[1]][,1],W[[2]][,1][-1],W[[3]][,1])
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
pchisq(q = H,df = k-1,lower.tail = F)
combn(unlist(lapply(D,mean)),m = 2)
n
combn(n,m = 2)
combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,]
dif <- abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])
dif
combn(n,m = 2)
1/combn(n,m = 2)
1/combn(n,m = 2)[1,]
sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)
qnorm(0.05 /k*(k-1),lower.tail = F)
sqrt(N*(N+1)/12)
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)
abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])
sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
dif <- abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
dif
combn(n,m = 2)[1,]
combn(n,m = 2)
sqrt(1/10+1/10)
sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
qnorm(0.15 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)
dif <- abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
dif
abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])
combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,]
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
dif <- abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])
dif
dif <- abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
dif
combn(1:3,m = 2)
abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])
abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,]))
rbind(combn(1:3,m = 2),
abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,]))
as.chatacter
as.chatacter(1)
as.chatactor(1)
as.character(TRUE)
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,]))
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,]))
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
RoundingTimes <-list(W[[1]][,1],W[[2]][,1],W[[3]][,1])
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
pchisq(q = H,df = k-1,lower.tail = F)
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
pchisq(q = H,df = k-1,lower.tail = F)
0.05 <pchisq(q = H,df = k-1,lower.tail = F)
0.05 > pchisq(q = H,df = k-1,lower.tail = F)
print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
RoundingTimes <-list(W[[1]][,2],W[[2]][,2],W[[3]][,2])
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
4
RoundingTimes <-list(W[[1]][,4],W[[2]][,4],W[[3]][,4])
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
D
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
RoundingTimes
list(W[[1]][,4],W[[2]][,4],W[[3]][,4])
boxplot(list(W[[1]][,4],W[[2]][,4],W[[3]][,4]))
RoundingTimes <-list(W[[1]][,4],W[[2]][,4],W[[3]][,4])
boxplot(list(W[[1]][,4],W[[2]][,4],W[[3]][,4]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
abline(h=lapply(RoundingTimes, function(x){prod(x)^(1/length(x))}))
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
boxplot(list(W[[1]][,4],W[[2]][,4],W[[3]][,4]))
boxplot(list(W[[1]][,4],W[[2]][,4],W[[3]][,4]))
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
c <- 4
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
c <- 3
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
c <- 3
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
c <- 2
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
c <- 1
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
c <- 4
c <- 4
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
W[[3]]
prod(x)^(1/length(x))
prod(W[[3]])^(1/length(W[[3]]))
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
apply(W[[3]],2,function(x){prod(x)^(1/length(x))})
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
c <- 4
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
apply(W[[3]],2,function(x){prod(x)^(1/length(x))})
W[[1]][,c]
W[[1]][,1]
W[[1]][,2]
hist(W[[1]][,2])
library(pmr)
surv <- matrix(NA,nrow = 10,ncol = 6)
NineNoin <- c(3,1,7,5)
NineJung <- c(1,7,3,5)
NineShin <- c(7,1,3,5)
W <- list()
itr <- 1
for(group in list(NineNoin,NineJung,NineShin)){
for(i in 1:10){
surv[i,] <-onenine(group)+c(rnorm(1,0,0.3),
rnorm(1,0,0.3),
rnorm(1,0,0.3),
rnorm(1,0,0.3),
rnorm(1,0,0.3),
rnorm(1,0,0.3))
}
cand <- c(1/(1:9),1:9)
result <- matrix(NA,nrow = 0,ncol = 6)
for(r in as.data.frame(t(surv))){
print(r)
num <- rep(0,0)
for (e in r){
num <- c(num,cand[which.min(abs((e)-cand))])
}
result <- rbind(result,num)
}
Noin <- diag(1,4,4)
weight <- matrix(NA,nrow=0,ncol=4)
for(r in as.data.frame(t(result))){
Noin[upper.tri(Noin)] <- r
tN <- t(Noin)
tN[upper.tri(Noin)] <- 1/Noin[upper.tri(Noin)]
Noin <- t(tN)
print(suppressMessages(ahp(Noin)$Saaty))
if(suppressMessages(ahp(Noin)$Saaty)<=0.1)
weight <- suppressMessages(rbind(weight,ahp(Noin)$weight))
}
W[[itr]] <- weight
itr <- itr+1
}
c <- 4
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
RoundingTimes
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
apply(W[[3]],2,function(x){prod(x)^(1/length(x))})
c <- 3
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
apply(W[[3]],2,function(x){prod(x)^(1/length(x))})
c <- 2
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
c <- 1
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
c(rnorm(1,0,0.3),  rnorm(1,0,0.3),
rnorm(1,0,0.3),
rnorm(1,0,0.3))
c(rnorm(1,0,0.3),
rnorm(1,0,0.3),
rnorm(1,0,0.3),
rnorm(1,0,0.3))
rnorm(4,0,0.3)
c(rnorm(1,0,0,1),rnorm(1,0,0,1),rnorm(1,0,0,1),rnorm(1,0,0,1))
c(rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1))
c(rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1))
c(rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1))
c(rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1))
c(rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1))
rnorm(4,0,0.3)
library(pmr)
surv <- matrix(NA,nrow = 10,ncol = 6)
NineNoin <- c(3,1,7,5)
NineJung <- c(1,7,3,5)
NineShin <- c(7,1,3,5)
W <- list()
itr <- 1
for(group in list(NineNoin,NineJung,NineShin)){
for(i in 1:10){
group <- group + c(rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1))
surv[i,] <-onenine(group)
}
cand <- c(1/(1:9),1:9)
result <- matrix(NA,nrow = 0,ncol = 6)
for(r in as.data.frame(t(surv))){
print(r)
num <- rep(0,0)
for (e in r){
num <- c(num,cand[which.min(abs((e)-cand))])
}
result <- rbind(result,num)
}
Noin <- diag(1,4,4)
weight <- matrix(NA,nrow=0,ncol=4)
for(r in as.data.frame(t(result))){
Noin[upper.tri(Noin)] <- r
tN <- t(Noin)
tN[upper.tri(Noin)] <- 1/Noin[upper.tri(Noin)]
Noin <- t(tN)
print(suppressMessages(ahp(Noin)$Saaty))
if(suppressMessages(ahp(Noin)$Saaty)<=0.1)
weight <- suppressMessages(rbind(weight,ahp(Noin)$weight))
}
W[[itr]] <- weight
itr <- itr+1
}
W
c <- 4
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
library(pmr)
surv <- matrix(NA,nrow = 10,ncol = 6)
NineNoin <- c(3,1,7,5)
NineJung <- c(1,7,3,6)
NineShin <- c(7,1,3,6)
W <- list()
itr <- 1
for(group in list(NineNoin,NineJung,NineShin)){
for(i in 1:10){
group <- group + c(rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1),rnorm(1,0,1))
surv[i,] <-onenine(group)
}
cand <- c(1/(1:9),1:9)
result <- matrix(NA,nrow = 0,ncol = 6)
for(r in as.data.frame(t(surv))){
print(r)
num <- rep(0,0)
for (e in r){
num <- c(num,cand[which.min(abs((e)-cand))])
}
result <- rbind(result,num)
}
Noin <- diag(1,4,4)
weight <- matrix(NA,nrow=0,ncol=4)
for(r in as.data.frame(t(result))){
Noin[upper.tri(Noin)] <- r
tN <- t(Noin)
tN[upper.tri(Noin)] <- 1/Noin[upper.tri(Noin)]
Noin <- t(tN)
print(suppressMessages(ahp(Noin)$Saaty))
if(suppressMessages(ahp(Noin)$Saaty)<=0.1)
weight <- suppressMessages(rbind(weight,ahp(Noin)$weight))
}
W[[itr]] <- weight
itr <- itr+1
}
c <- 4
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
if(print(0.05 > pchisq(q = H,df = k-1,lower.tail = F))){
rbind(combn(1:3,m = 2),
as.character(abs(combn(unlist(lapply(D,mean)),m = 2)[1,]-combn(unlist(lapply(D,mean)),m = 2)[2,])>
qnorm(0.05 /k*(k-1),lower.tail = F)*sqrt(N*(N+1)/12)*sqrt(1/combn(n,m = 2)[1,]+1/combn(n,m = 2)[2,])))
}
lapply(RoundingTimes, function(x){prod(x)^(1/length(x))})
W
View(arow)
View(W[[1]])
View(W[[2]])
View(W[[3]])
c <- 4
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
RoundingTimes
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
D
n
D
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
H
c <- 4
RoundingTimes <-list(W[[1]][,c],W[[2]][,c],W[[3]][,c])
boxplot(list(W[[1]][,c],W[[2]][,c],W[[3]][,c]))
k <- length(RoundingTimes)
n <- unlist(lapply(RoundingTimes, length))
N <- sum(n)
listRank <- rank(unlist(RoundingTimes),ties.method = "average")
D <- list(listRank[1:n[1]],listRank[(n[1]+1):(n[1]+n[2])],listRank[(n[1]+n[2]+1):(n[1]+n[2]+n[3])])
H <- 12/N/(N+1)*sum(n*(unlist(lapply(D,mean))-mean(unlist(D)))^2)
pchisq(q = H,df = k-1,lower.tail = F)
H
qchisq(p = 0.05,df = k-1,lower.tail = F)
pchisq(q = H,df = k-1,lower.tail = F)
